# **Token based Authentication:**

Token-based authentication is a method of authentication where a token is generated and used to authenticate requests from clients. It eliminates the need for session management on the server-side and allows for stateless communication.

**Server Generates one Token after validating user login details:**

When a user provides their login credentials (such as username and password), the server verifies these details. If the credentials are valid, the server generates a token. This token is a unique string of characters that represents the user's authentication.

**Security Hashing Algorithm and Secret Key:**

To enhance security, the server uses a hashing algorithm (e.g., SHA-256) to generate a secure hash of the user's credentials. The server also employs a secret key, which is a random and confidential string of characters. The secret key is used during the token generation process to sign the token and prevent tampering or forgery.

**Sending the Token to the Client:**

Once the token is generated, it is sent back to the client as part of the server's response. The token can be included in the response body, response headers (e.g., the Authorization header), or even as a cookie. The client application needs to store this token securely for future use.

**Server Does Not Store User Data:**

In token-based authentication, the server does not need to store user data, such as session information or tokens. The server relies on the client to present the token for each request, and it validates the token to authenticate the client. This statelessness simplifies the server-side implementation and reduces storage requirements.

**Sending Token with Requests:**

When the client wants to make a request to a protected resource on the server, it includes the token in the request. This is typically done by including the token in the request headers, such as the Authorization header, using a specific format like "Bearer token_value". The server uses this token to identify and authenticate the client.

**Validating the Token:**

Upon receiving a request with a token, the server validates the token's authenticity and integrity. It uses the same secret key that was used during token generation to verify the token's signature. If the token is valid, the server processes the request and provides the appropriate response. However, if the token is invalid or has expired, the server may respond with an error or redirect the client to a login page.

Token-based authentication in Spring Boot Security provides a secure and scalable approach to authentication. By using tokens, it eliminates the need for server-side sessions and simplifies the authentication process. The tokens are securely generated and can be easily validated by the server using the secret key. This approach enhances security, improves performance, and allows for stateless communication between the client and server.

<br/>
<br/>

# Here is a detailed explanation of JSON Web Tokens (JWT) and its implementation using the JJWT library in Java.

**JWT - JSON Web Token is used to implement Token based Authentication:**

JSON Web Token (JWT) is a compact and self-contained method for securely transmitting information between parties as a JSON object. It is commonly used to implement token-based authentication systems, where tokens are generated, validated, and used for authentication purposes.

**JJWT is an open-source API used by Java applications to generate, validate, and parse Tokens:**

JJWT (Java JWT) is an open-source library that provides a simple API for generating, validating, and parsing JSON Web Tokens in Java applications. It simplifies the process of working with JWTs, making it easier to implement token-based authentication in Java.

**Dependency for JJWT in Maven:**

To use JJWT in a Java application, you need to include the JJWT dependency in your project's Maven configuration. The following XML snippet shows the necessary dependency declaration:

```xml
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt</artifactId>
    <version>0.9.1</version>
</dependency>
```

This dependency ensures that your application has access to the JJWT library and its functionality.

**JWT Token Contains 3 Parts: Head, Payload, and Signature:**

A JWT token consists of three parts: the header, the payload, and the signature.

1. Head: The header contains metadata about the JWT, such as the token's signing algorithm (e.g., HS256) and the type of token (e.g., JWT).
2. Payload: The payload holds the claims or statements about the authenticated entity (e.g., user details like username, expiration date, provider, etc.).
3. Signature: The signature is generated by combining the encoded header and encoded payload, along with a secret key. It ensures the integrity and authenticity of the token. The server validates the signature using the same secret key to ensure the token's validity.

**Token Format: xxxxxxxxxx.yyyyyyyyyyyyyyyy.zzzzzzzzzzz:**

The JWT token is formatted as a string consisting of three parts, separated by dots. The three parts are the base64-encoded header, the base64-encoded payload, and the signature. The token format looks like this: `xxxxxxxxxx.yyyyyyyyyyyyyyyy.zzzzzzzzzzz`.

**Always validate the Signature at the server using the Secret:**

To ensure the integrity and authenticity of the token, the server must validate the token's signature using the secret key. The secret key should be securely stored and known only to the server. By validating the signature, the server can verify that the token has not been tampered with and that it was indeed generated by a trusted source.

Using JJWT, you can easily generate, validate, and parse JWT tokens in your Java application. It simplifies the token-based authentication process by providing a convenient API. By understanding the structure of JWT tokens and the role of the JJWT library, you can implement secure token-based authentication in your Java application.

<br/>
<br/>

# Let's go through each point and provide a detailed explanation of the Maven project configuration and the test class that uses the JJWT library.

**Maven Project:**

The Maven project configuration specifies the properties and dependencies for the project. Here are the relevant parts:

```xml
<properties>
    <maven.compiler.source>11</maven.compiler.source>
    <maven.compiler.target>11</maven.compiler.target>
</properties>

<dependencies>
    <dependency>
        <groupId>io.jsonwebtoken</groupId>
        <artifactId>jjwt</artifactId>
        <version>0.9.1</version>
    </dependency>

    <dependency>
        <groupId>javax.xml.bind</groupId>
        <artifactId>jaxb-api</artifactId>
        <version>2.3.1</version>
    </dependency>
</dependencies>
```

- The `<properties>` section sets the source and target compatibility for the Maven compiler to Java 11.
- The `<dependencies>` section lists the dependencies required for the project. In this case, it includes the JJWT library (io.jsonwebtoken:jjwt:0.9.1) and the JAXB API (javax.xml.bind:jaxb-api:2.3.1).

**Test class:**

The provided test class demonstrates the usage of JJWT to generate and parse JWT tokens. Let's go through it:

```java
package com.app.shivam;

import java.util.Date;
import java.util.concurrent.TimeUnit;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;

public class Test {

    public static void main(String[] args) {
        String secret = "TestAppOneSample";
        
        String token = Jwts.builder()
                .setId("8562455") // user UnqId
                .setSubject("sample") // username
                .setIssuedAt(new Date(System.currentTimeMillis())) // created time
                .setExpiration(new Date(System.currentTimeMillis() + TimeUnit.MINUTES.toMillis(2))) // exp time
                .setIssuer("VIKASHIT") // token provider name
                .signWith(SignatureAlgorithm.HS256, secret.getBytes()) // sec algo, secret
                .compact();
        
        System.out.println(token);
        
        Claims c = Jwts.parser()
                .setSigningKey(secret.getBytes())
                .parseClaimsJws(token).getBody();
        
        System.out.println(c.getSubject());
        System.out.println(c.getIssuer());
        System.out.println(c.getExpiration());
    }
}
```

- The `Test` class demonstrates the generation and parsing of a JWT token using JJWT.
- The `secret` variable represents the secret key used to sign and verify the token. In this example, it is set as "TestAppOneSample". Remember that in a real-world scenario, you should store and manage the secret securely.
- The `Jwts.builder()` method is used to start building the token.
- The `.setId("8562455")` sets the unique identifier for the user.
- The `.setSubject("sample")` sets the username or any other subject information.
- The `.setIssuedAt(new Date(System.currentTimeMillis()))` sets the token's creation time.
- The `.setExpiration(new Date(System.currentTimeMillis() + TimeUnit.MINUTES.toMillis(2)))` sets the token's expiration time, in this case, 2 minutes from the creation time.
- The `.setIssuer("VIKASHIT")` sets the token's issuer, representing the token provider.
- The `.signWith(SignatureAlgorithm.HS256, secret.getBytes())` signs the token using the HS256 algorithm and the secret key.
- The `.compact()` method generates the final compact JWT token as a string.
- The generated token is printed to the console using `System.out.println(token)`.

- The `Jwts.parser()` method is used to create a parser for JWT tokens.
- The `.setSigningKey(secret.getBytes())` sets the secret key for token verification.
- The `parseClaimsJws(token)` method parses and verifies the token. It returns a `Jws<Claims>` object.
- The `.getBody()` method retrieves the claims (payload) from the parsed token.
- The `c.getSubject()`, `c.getIssuer()`, and `c.getExpiration()` methods retrieve and print the subject, issuer, and expiration date from the parsed token, respectively.

By running this test class, you can generate a JWT token, parse it, and retrieve the claims from it. This example demonstrates the basic usage of JJWT for token generation and verification.